{
  "_args": [
    [
      {
        "raw": "agentkeepalive@^4.1.3",
        "scope": null,
        "escapedName": "agentkeepalive",
        "name": "agentkeepalive",
        "rawSpec": "^4.1.3",
        "spec": ">=4.1.3 <5.0.0",
        "type": "range"
      },
      "c:\\Angular\\TaskManager\\node_modules\\make-fetch-happen"
    ]
  ],
  "_from": "agentkeepalive@^4.1.3",
  "_hasShrinkwrap": false,
  "_id": "agentkeepalive@4.1.4",
  "_location": "/agentkeepalive",
  "_nodeVersion": "12.20.1",
  "_npmOperationalInternal": {
    "host": "s3://npm-registry-packages",
    "tmp": "tmp/agentkeepalive_4.1.4_1612490400040_0.2855063189560194"
  },
  "_npmUser": {
    "name": "fengmk2",
    "email": "fengmk2@gmail.com"
  },
  "_npmVersion": "6.11.3",
  "_phantomChildren": {},
  "_requested": {
    "raw": "agentkeepalive@^4.1.3",
    "scope": null,
    "escapedName": "agentkeepalive",
    "name": "agentkeepalive",
    "rawSpec": "^4.1.3",
    "spec": ">=4.1.3 <5.0.0",
    "type": "range"
  },
  "_requiredBy": [
    "/make-fetch-happen"
  ],
  "_resolved": "https://registry.npmjs.org/agentkeepalive/-/agentkeepalive-4.1.4.tgz",
  "_shasum": "d928028a4862cb11718e55227872e842a44c945b",
  "_shrinkwrap": null,
  "_spec": "agentkeepalive@^4.1.3",
  "_where": "c:\\Angular\\TaskManager\\node_modules\\make-fetch-happen",
  "author": {
    "name": "fengmk2",
    "email": "fengmk2@gmail.com",
    "url": "https://fengmk2.com"
  },
  "browser": "browser.js",
  "bugs": {
    "url": "https://github.com/node-modules/agentkeepalive/issues"
  },
  "ci": {
    "type": "github",
    "os": {
      "github": "linux"
    },
    "version": "8, 10, 12, 14"
  },
  "contributors": [
    {
      "name": "fengmk2",
      "email": "fengmk2@gmail.com",
      "url": "https://github.com/fengmk2"
    },
    {
      "name": "Will White",
      "email": "will@mapbox.com",
      "url": "https://github.com/willwhite"
    },
    {
      "name": "dead-horse",
      "email": "heyiyu.deadhorse@gmail.com",
      "url": "https://github.com/dead-horse"
    },
    {
      "name": "Zsolt Lattmann",
      "email": "lattmann@isis.vanderbilt.edu",
      "url": "https://github.com/lattmann"
    },
    {
      "name": "Patrick Malouin",
      "email": "p.malouin@gmail.com",
      "url": "https://github.com/pmalouin"
    },
    {
      "name": "Alexander Penev",
      "email": "alexander.penev@sap.com",
      "url": "https://github.com/saperal"
    },
    {
      "name": "Dylan Piercey",
      "email": "pierceydylan@gmail.com",
      "url": "https://github.com/DylanPiercey"
    },
    {
      "name": "Marcio Rodrigues",
      "email": "marcio.silva@vivareal.com",
      "url": "https://github.com/marciorodrigues87"
    }
  ],
  "dependencies": {
    "debug": "^4.1.0",
    "depd": "^1.1.2",
    "humanize-ms": "^1.2.1"
  },
  "description": "Missing keepalive http.Agent",
  "devDependencies": {
    "autod": "^3.0.1",
    "coffee": "^5.3.0",
    "cross-env": "^6.0.3",
    "egg-bin": "^4.9.0",
    "egg-ci": "^1.10.0",
    "eslint": "^5.7.0",
    "eslint-config-egg": "^7.1.0",
    "mm": "^2.4.1",
    "pedding": "^1.1.0",
    "typescript": "^3.8.3"
  },
  "directories": {},
  "dist": {
    "integrity": "sha512-+V/rGa3EuU74H6wR04plBb7Ks10FbtUQgRj/FQOG7uUIEuaINI+AiqJR1k6t3SVNs7o7ZjIdus6706qqzVq8jQ==",
    "shasum": "d928028a4862cb11718e55227872e842a44c945b",
    "tarball": "https://registry.npmjs.org/agentkeepalive/-/agentkeepalive-4.1.4.tgz",
    "fileCount": 10,
    "unpackedSize": 37186,
    "npm-signature": "-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.13\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJgHKagCRA9TVsSAnZWagAA7eAP+wUtMICQUoTc/eNcW5FM\nyV6XfXrvEaAeuEziNeosbzkpyM93+pQf6VC6TWQFkErwV/jkUJxtDnYmnY8e\nXHeA3w9olrU7pK2SD61ifN4AvrcE44XLC3ImnvxakIhS1PTHKudIk2652851\nFVdnCO4z1b/4Ln8krW9quNvod+QnudHfUg3QtGuPNHgXEEh+a2IMEBlhNKJb\nGanvfrq7ZFKmOUVOKCth2uA8EREdiFd/HgxoQUiNWfdnMboGVXdYaca3Vti4\nkuH8oRVN3+FojwmgRNJoJWkcMbpLtYI/Bd1jPz7hqJHdafCPh1Hqr9CRVG3K\nGXaQsjvd50sgrsJHltoTZ14nPDrzuWWEkfdItxG25Kh2BxDOYKR4j/a9Jvvp\n+08VINNGHV5/8CZN5VuRxwvMNGww8AlzMt1Sqk4Sb98RAeDWoFIHposapsQZ\n8f320yvwXapDmNyuUq0FixrBDpvmOEw0a8O8+6VItXObaehfBE8ZKUlfXkvQ\nTmOPlYDDiJjB2o0vvkQQiRFKm4Gfh8bAvlfsmOykqla+Gz8EIkfMwFcxMJrs\nZBoE5qYFq3S2BI4Dz2aeAZcG+8TrvXa0S/T339hqK57ThfwstSsTorPGOwMs\nZBAvKd4bs3t7iBDHuqIyJjtQ6XWH9ocwyQparkM9k2Gm3xWNtmIzpnP8UF0S\nP7rv\r\n=mpAc\r\n-----END PGP SIGNATURE-----\r\n"
  },
  "engines": {
    "node": ">= 8.0.0"
  },
  "files": [
    "index.js",
    "index.d.ts",
    "browser.js",
    "lib"
  ],
  "gitHead": "01e61e9e53526df2231152ef4287d38332f4db45",
  "homepage": "https://github.com/node-modules/agentkeepalive#readme",
  "keywords": [
    "http",
    "https",
    "agent",
    "keepalive",
    "agentkeepalive",
    "HttpAgent",
    "HttpsAgent"
  ],
  "license": "MIT",
  "main": "index.js",
  "maintainers": [
    {
      "name": "dead-horse",
      "email": "dead_horse@qq.com"
    },
    {
      "name": "dead_horse",
      "email": "dead_horse@qq.com"
    },
    {
      "name": "fengmk2",
      "email": "fengmk2@gmail.com"
    },
    {
      "name": "popomore",
      "email": "sakura9515@gmail.com"
    }
  ],
  "name": "agentkeepalive",
  "optionalDependencies": {},
  "readme": "# agentkeepalive\n\n[![NPM version][npm-image]][npm-url]\n[![Known Vulnerabilities][snyk-image]][snyk-url]\n[![npm download][download-image]][download-url]\n\n[npm-image]: https://img.shields.io/npm/v/agentkeepalive.svg?style=flat\n[npm-url]: https://npmjs.org/package/agentkeepalive\n[snyk-image]: https://snyk.io/test/npm/agentkeepalive/badge.svg?style=flat-square\n[snyk-url]: https://snyk.io/test/npm/agentkeepalive\n[download-image]: https://img.shields.io/npm/dm/agentkeepalive.svg?style=flat-square\n[download-url]: https://npmjs.org/package/agentkeepalive\n\nThe enhancement features `keep alive` `http.Agent`. Support `http` and `https`.\n\n## What's different from original `http.Agent`?\n\n- `keepAlive=true` by default\n- Disable Nagle's algorithm: `socket.setNoDelay(true)`\n- Add free socket timeout: avoid long time inactivity socket leak in the free-sockets queue.\n- Add active socket timeout: avoid long time inactivity socket leak in the active-sockets queue.\n- TTL for active socket.\n\n## Node.js version required\n\nSupport Node.js >= `8.0.0`\n\n## Install\n\n```bash\n$ npm install agentkeepalive --save\n```\n\n## new Agent([options])\n\n* `options` {Object} Set of configurable options to set on the agent.\n  Can have the following fields:\n  * `keepAlive` {Boolean} Keep sockets around in a pool to be used by\n    other requests in the future. Default = `true`.\n  * `keepAliveMsecs` {Number} When using the keepAlive option, specifies the initial delay\n    for TCP Keep-Alive packets. Ignored when the keepAlive option is false or undefined. Defaults to 1000.\n    Default = `1000`.  Only relevant if `keepAlive` is set to `true`.\n  * `freeSocketTimeout`: {Number} Sets the free socket to timeout\n    after `freeSocketTimeout` milliseconds of inactivity on the free socket.\n    Default is `15000`.\n    Only relevant if `keepAlive` is set to `true`.\n  * `timeout`: {Number} Sets the working socket to timeout\n    after `timeout` milliseconds of inactivity on the working socket.\n    Default is `freeSocketTimeout * 2`.\n  * `maxSockets` {Number} Maximum number of sockets to allow per\n    host. Default = `Infinity`.\n  * `maxFreeSockets` {Number} Maximum number of sockets (per host) to leave open\n    in a free state. Only relevant if `keepAlive` is set to `true`.\n    Default = `256`.\n  * `socketActiveTTL` {Number} Sets the socket active time to live, even if it's in use.\n    If not set, the behaviour keeps the same (the socket will be released only when free)\n    Default = `null`.\n\n## Usage\n\n```js\nconst http = require('http');\nconst Agent = require('agentkeepalive');\n\nconst keepaliveAgent = new Agent({\n  maxSockets: 100,\n  maxFreeSockets: 10,\n  timeout: 60000, // active socket keepalive for 60 seconds\n  freeSocketTimeout: 30000, // free socket keepalive for 30 seconds\n});\n\nconst options = {\n  host: 'cnodejs.org',\n  port: 80,\n  path: '/',\n  method: 'GET',\n  agent: keepaliveAgent,\n};\n\nconst req = http.request(options, res => {\n  console.log('STATUS: ' + res.statusCode);\n  console.log('HEADERS: ' + JSON.stringify(res.headers));\n  res.setEncoding('utf8');\n  res.on('data', function (chunk) {\n    console.log('BODY: ' + chunk);\n  });\n});\nreq.on('error', e => {\n  console.log('problem with request: ' + e.message);\n});\nreq.end();\n\nsetTimeout(() => {\n  if (keepaliveAgent.statusChanged) {\n    console.log('[%s] agent status changed: %j', Date(), keepaliveAgent.getCurrentStatus());\n  }\n}, 2000);\n\n```\n\n### `getter agent.statusChanged`\n\ncounters have change or not after last checkpoint.\n\n### `agent.getCurrentStatus()`\n\n`agent.getCurrentStatus()` will return a object to show the status of this agent:\n\n```js\n{\n  createSocketCount: 10,\n  closeSocketCount: 5,\n  timeoutSocketCount: 0,\n  requestCount: 5,\n  freeSockets: { 'localhost:57479:': 3 },\n  sockets: { 'localhost:57479:': 5 },\n  requests: {}\n}\n```\n\n### Support `https`\n\n```js\nconst https = require('https');\nconst HttpsAgent = require('agentkeepalive').HttpsAgent;\n\nconst keepaliveAgent = new HttpsAgent();\n// https://www.google.com/search?q=nodejs&sugexp=chrome,mod=12&sourceid=chrome&ie=UTF-8\nconst options = {\n  host: 'www.google.com',\n  port: 443,\n  path: '/search?q=nodejs&sugexp=chrome,mod=12&sourceid=chrome&ie=UTF-8',\n  method: 'GET',\n  agent: keepaliveAgent,\n};\n\nconst req = https.request(options, res => {\n  console.log('STATUS: ' + res.statusCode);\n  console.log('HEADERS: ' + JSON.stringify(res.headers));\n  res.setEncoding('utf8');\n  res.on('data', chunk => {\n    console.log('BODY: ' + chunk);\n  });\n});\n\nreq.on('error', e => {\n  console.log('problem with request: ' + e.message);\n});\nreq.end();\n\nsetTimeout(() => {\n  console.log('agent status: %j', keepaliveAgent.getCurrentStatus());\n}, 2000);\n```\n\n### Support `req.reusedSocket`\n\nThis agent implements the `req.reusedSocket` to determine whether a request is send through a reused socket.\n\nWhen server closes connection at unfortunate time ([keep-alive race](https://code-examples.net/en/q/28a8069)), the http client will throw a `ECONNRESET` error. Under this circumstance, `req.reusedSocket` is useful when we want to retry the request automatically.\n\n```js\nconst http = require('http');\nconst Agent = require('agentkeepalive');\nconst agent = new Agent();\n\nconst req = http\n  .get('http://localhost:3000', { agent }, (res) => {\n    // ...\n  })\n  .on('error', (err) => {\n    if (req.reusedSocket && err.code === 'ECONNRESET') {\n      // retry the request or anything else...\n    }\n  })\n```\n\nThis behavior is consistent with Node.js core. But through `agentkeepalive`, you can use this feature in older Node.js version.\n\n## [Benchmark](https://github.com/node-modules/agentkeepalive/tree/master/benchmark)\n\nrun the benchmark:\n\n```bash\ncd benchmark\nsh start.sh\n```\n\nIntel(R) Core(TM)2 Duo CPU     P8600  @ 2.40GHz\n\nnode@v0.8.9\n\n50 maxSockets, 60 concurrent, 1000 requests per concurrent, 5ms delay\n\nKeep alive agent (30 seconds):\n\n```js\nTransactions:          60000 hits\nAvailability:         100.00 %\nElapsed time:          29.70 secs\nData transferred:        14.88 MB\nResponse time:            0.03 secs\nTransaction rate:      2020.20 trans/sec\nThroughput:           0.50 MB/sec\nConcurrency:           59.84\nSuccessful transactions:       60000\nFailed transactions:             0\nLongest transaction:          0.15\nShortest transaction:         0.01\n```\n\nNormal agent:\n\n```js\nTransactions:          60000 hits\nAvailability:         100.00 %\nElapsed time:          46.53 secs\nData transferred:        14.88 MB\nResponse time:            0.05 secs\nTransaction rate:      1289.49 trans/sec\nThroughput:           0.32 MB/sec\nConcurrency:           59.81\nSuccessful transactions:       60000\nFailed transactions:             0\nLongest transaction:          0.45\nShortest transaction:         0.00\n```\n\nSocket created:\n\n```bash\n[proxy.js:120000] keepalive, 50 created, 60000 requestFinished, 1200 req/socket, 0 requests, 0 sockets, 0 unusedSockets, 50 timeout\n{\" <10ms\":662,\" <15ms\":17825,\" <20ms\":20552,\" <30ms\":17646,\" <40ms\":2315,\" <50ms\":567,\" <100ms\":377,\" <150ms\":56,\" <200ms\":0,\" >=200ms+\":0}\n----------------------------------------------------------------\n[proxy.js:120000] normal   , 53866 created, 84260 requestFinished, 1.56 req/socket, 0 requests, 0 sockets\n{\" <10ms\":75,\" <15ms\":1112,\" <20ms\":10947,\" <30ms\":32130,\" <40ms\":8228,\" <50ms\":3002,\" <100ms\":4274,\" <150ms\":181,\" <200ms\":18,\" >=200ms+\":33}\n```\n\n## License\n\n[MIT](LICENSE)\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git://github.com/node-modules/agentkeepalive.git"
  },
  "scripts": {
    "autod": "autod",
    "ci": "npm run lint && npm run cov",
    "cov": "cross-env DEBUG=agentkeepalive egg-bin cov --full-trace",
    "lint": "eslint lib test index.js",
    "test": "npm run lint && egg-bin test --full-trace",
    "test-local": "egg-bin test --full-trace"
  },
  "version": "4.1.4"
}
